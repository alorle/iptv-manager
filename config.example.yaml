# IPTV Manager Configuration
# All settings can be overridden by environment variables

# HTTP server settings
http:
  address: "127.0.0.1"  # Bind address (env: HTTP_ADDRESS)
  port: "8080"          # Port to listen on (env: HTTP_PORT)

# Acestream Engine settings
acestream:
  engine_url: "http://127.0.0.1:6878"                      # Acestream Engine URL (env: ACESTREAM_ENGINE_URL)
  player_base_url: "http://127.0.0.1:6878/ace/getstream"  # Acestream Player base URL (env: ACESTREAM_PLAYER_BASE_URL)

# Cache settings
cache:
  dir: "/tmp/iptv-manager-cache"  # Cache directory - REQUIRED (env: CACHE_DIR)
  ttl: "1h"                        # Cache time-to-live - REQUIRED (env: CACHE_TTL)

# Proxy settings
proxy:
  read_timeout: "5s"      # HTTP read timeout (env: PROXY_READ_TIMEOUT)
  write_timeout: "10s"    # HTTP write timeout (env: PROXY_WRITE_TIMEOUT)
  buffer_size: 4194304    # Proxy buffer size in bytes (4MB) (env: PROXY_BUFFER_SIZE)

# Stream settings
stream:
  buffer_size: 1048576        # Stream buffer size in bytes (1MB) (env: STREAM_BUFFER_SIZE)
  use_multiplexing: true      # Enable stream multiplexing (env: USE_MULTIPLEXING)

# Playlist sources - list of M3U URLs to merge
playlists:
  - name: "elcano"
    url: "https://ipfs.io/ipns/k51qzi5uqu5di462t7j4vu4akwfhvtjhy88qbupktvoacqfqe9uforjvhyi4wr/hashes_acestream.m3u"
  - name: "newera"
    url: "https://ipfs.io/ipns/k2k4r8oqlcjxsritt5mczkcn4mmvcmymbqw7113fz2flkrerfwfps004/data/listas/lista_fuera_iptv.m3u"

# EPG (Electronic Program Guide) settings
epg:
  url: "https://raw.githubusercontent.com/davidmuma/EPG_dobleM/master/guiatv.xml"  # EPG XML URL (env: EPG_URL)

# Resilience settings
resilience:
  # Reconnection settings
  reconnect_buffer_size: 2097152          # Buffer size for reconnection data in bytes (2MB) (env: RECONNECT_BUFFER_SIZE)
  reconnect_max_backoff: "30s"            # Maximum backoff duration between retries (env: RECONNECT_MAX_BACKOFF)
  reconnect_initial_backoff: "500ms"      # Initial backoff duration (env: RECONNECT_INITIAL_BACKOFF)

  # Circuit breaker settings
  cb_failure_threshold: 5                 # Number of failures before opening circuit (env: CB_FAILURE_THRESHOLD)
  cb_timeout: "30s"                       # Timeout before attempting to close circuit (env: CB_TIMEOUT)
  cb_half_open_requests: 1                # Number of requests allowed in half-open state (env: CB_HALF_OPEN_REQUESTS)

  # Health check settings
  health_check_interval: "30s"            # Interval between health checks (env: HEALTH_CHECK_INTERVAL)

  # Logging settings
  log_level: "INFO"                       # Log level: DEBUG, INFO, WARN, ERROR (env: LOG_LEVEL)
